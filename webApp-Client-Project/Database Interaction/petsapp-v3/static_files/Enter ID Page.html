<!DOCTYPE html>
<html>

      <head>
            <meta name="viewport" content="width=device-width, initial-scale=1">
            <title>Student Event Sign Up</title>
       </head>

       <!-- The core Firebase JS SDK is always required and must be listed first -->
       <script src="https://www.gstatic.com/firebasejs/4.13.0/firebase.js"></script>

       <script>
       // Your web app's Firebase configuration
       var firebaseConfig = {
          apiKey: "AIzaSyCCgoy1_bJzrruepLYIWBbrIUIGxM-p2CQ",
          authDomain: "signup-form-e4c78.firebaseapp.com",
          databaseURL: "https://signup-form-e4c78.firebaseio.com",
          projectId: "signup-form-e4c78",
          storageBucket: "signup-form-e4c78.appspot.com",
          messagingSenderId: "1000336889334",
          appId: "1:1000336889334:web:f5099e3a8ecc1584"
       };
       // Initialize Firebase
       firebase.initializeApp(firebaseConfig);
       </script>

      <script src="jquery-3.3.1.min.js"></script>
      <script type="text/javascript">

      function searchNames(query, box){
         console.log(query);
         var names = [["Last", "First", "ID"]];
         const database=firebase.database();
         const key='students/';
         database.ref(key).once('value', (snapshot) => {
            const data= snapshot.val();
            if(!data){
               alert("Name does not exist.");
               return;
            }
            var ref = firebase.database().ref('students');
               ref.orderByChild('last').equalTo(query).on("value", function(snapshot) {
                  snapshot.forEach(function(child) { 
                     var info = [child.child("last").val(),child.child("first").val(),child.key]
                     names.push(info);
                  }); 
               });
         });
         clearOptions(box);
         for (var i = 0; i < names.length; i++){
            addOption(box, names[i][0]+", "+names[i][1]+"\t"+names[i][2], names[i][2]);
         }
      }

      function addOption(select, optText, name){
         var select = document.getElementById("resBox");
         select.options[select.options.length] = new Option(optText, name);
      }

      function clearOptions(box){
         try{
            for(var i = box.options.length - 1; i >= 0 ; i--){
               box.remove(i);
            }
         } catch(error){
            console.log("No options to clear.");
            console.log(error);
         }
      }

      </script>

      
   <body>
      <h2>Enter Name or Student ID # 
      </h2>
      <style>
         h2{
         font-family: Arial, Helvetica, sans-serif;
         }
         form{
         font-family: Arial, Helvetica, sans-serif;
         }
         input{
         font-family: Arial, Helvetica, sans-serif;
         }
      </style>
      <form action="/form.html">
         Student ID <br>
         <input type="number" name="Student+ID">
         <br>
         Last Name<br>
         <input type="text" name="lastname">
         <button type="button" onclick="Javascript:searchNames(lastname.value, 'resBox');"> Search </button><br>
         <p>Names will appear below</p>
         <select id="resBox" size="10">
            <option style="display:none" disabled selected value>Names</option>
         </select>
         <br><br>
         <input type="submit"  value="Submit" >
      <br> 
      </form>

      <button onclick="window.location.href = 'Main Page.html';">Back</button> <br>
   
</html>
